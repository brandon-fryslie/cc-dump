This file is a merged representation of a subset of the codebase, containing specifically included files, combined into a single document by Repomix.
The content has been processed where content has been compressed (code blocks are separated by ⋮---- delimiter).

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: src/textual/binding.py
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Content has been compressed - code blocks are separated by ⋮---- delimiter
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
src/
  textual/
    binding.py
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/textual/binding.py">
"""

This module contains the `Binding` class and related objects.

See [bindings](/guide/input#bindings) in the guide for details.
"""
⋮----
BindingType: TypeAlias = "Binding | tuple[str, str] | tuple[str, str, str]"
"""The possible types of a binding found in the `BINDINGS` class variable."""
⋮----
BindingIDString: TypeAlias = str
"""The ID of a Binding defined somewhere in the application.

Corresponds to the `id` parameter of the `Binding` class.
"""
⋮----
KeyString: TypeAlias = str
"""A string that represents a key binding.

For example, "x", "ctrl+i", "ctrl+shift+a", "ctrl+j,space,x", etc.
"""
⋮----
Keymap = Mapping[BindingIDString, KeyString]
"""A mapping of binding IDs to key strings, used for overriding default key bindings."""
⋮----
class BindingError(Exception)
⋮----
"""A binding related error."""
⋮----
class NoBinding(Exception)
⋮----
"""A binding was not found."""
⋮----
class InvalidBinding(Exception)
⋮----
"""Binding key is in an invalid format."""
⋮----
@dataclass(frozen=True)
class Binding
⋮----
"""The configuration of a key binding."""
⋮----
key: str
"""Key to bind. This can also be a comma-separated list of keys to map multiple keys to a single action."""
action: str
"""Action to bind to."""
description: str = ""
"""Description of action."""
show: bool = True
"""Show the action in Footer, or False to hide."""
key_display: str | None = None
"""How the key should be shown in footer.

    If `None`, the display of the key will use the result of `App.get_key_display`.

    If overridden in a keymap then this value is ignored.
    """
priority: bool = False
"""Enable priority binding for this key."""
tooltip: str = ""
"""Optional tooltip to show in footer."""
⋮----
id: str | None = None
"""ID of the binding. Intended to be globally unique, but uniqueness is not enforced.

    If specified in the App's keymap then Textual will use this ID to lookup the binding,
    and substitute the `key` property of the Binding with the key specified in the keymap.
    """
system: bool = False
"""Make this binding a system binding, which removes it from the key panel."""
⋮----
@dataclass(frozen=True)
    class Group
⋮----
"""A binding group causes the keys to be grouped under a single description."""
⋮----
"""Description of the group."""
⋮----
compact: bool = False
"""Show keys in compact form (no spaces)."""
⋮----
group: Group | None = None
"""Optional binding group (used to group related bindings in the footer)."""
⋮----
def parse_key(self) -> tuple[list[str], str]
⋮----
"""Parse a key into a list of modifiers, and the actual key.

        Returns:
            A tuple of (MODIFIER LIST, KEY).
        """
⋮----
def with_key(self, key: str, key_display: str | None = None) -> Binding
⋮----
"""Return a new binding with the key and key_display set to the specified values.

        Args:
            key: The new key to set.
            key_display: The new key display to set.

        Returns:
            A new binding with the key set to the specified value.
        """
⋮----
@classmethod
    def make_bindings(cls, bindings: Iterable[BindingType]) -> Iterable[Binding]
⋮----
"""Convert a list of BindingType (the types that can be specified in BINDINGS)
        into an Iterable[Binding].

        Compound bindings like "j,down" will be expanded into 2 Binding instances.

        Args:
            bindings: An iterable of BindingType.

        Returns:
            An iterable of Binding.
        """
bindings = list(bindings)
⋮----
# If it's a tuple of length 3, convert into a Binding first
⋮----
# `binding` is a tuple of 2 or 3 values at this point
binding = Binding(*binding)  # type: ignore[reportArgumentType]
⋮----
# At this point we have a Binding instance, but the key may
# be a list of keys, so now we unroll that single Binding
# into a (potential) collection of Binding instances.
⋮----
key = key.strip()
⋮----
key = _character_to_key(key)
⋮----
class ActiveBinding(NamedTuple)
⋮----
"""Information about an active binding (returned from [active_bindings][textual.screen.Screen.active_bindings])."""
⋮----
node: DOMNode
"""The node where the binding is defined."""
binding: Binding
"""The binding information."""
enabled: bool
"""Is the binding enabled? (enabled bindings are typically rendered dim)"""
⋮----
"""Optional tooltip shown in Footer."""
⋮----
@rich.repr.auto
class BindingsMap
⋮----
"""Manage a set of bindings."""
⋮----
"""Initialise a collection of bindings.

        Args:
            bindings: An optional set of initial bindings.

        Note:
            The iterable of bindings can contain either a `Binding`
            instance, or a tuple of 3 values mapping to the first three
            properties of a `Binding`.
        """
⋮----
"""Mapping of key (e.g. "ctrl+a") to list of bindings for that key."""
⋮----
def _add_binding(self, binding: Binding) -> None
⋮----
"""Add a new binding.

        Args:
            binding: New Binding to add.
        """
⋮----
def __iter__(self) -> Iterator[tuple[str, Binding]]
⋮----
"""Iterating produces a sequence of (KEY, BINDING) tuples."""
⋮----
@classmethod
    def from_keys(cls, keys: dict[str, list[Binding]]) -> BindingsMap
⋮----
"""Construct a BindingsMap from a dict of keys and bindings.

        Args:
            keys: A dict that maps a key on to a list of `Binding` objects.

        Returns:
            New `BindingsMap`
        """
bindings = cls()
⋮----
def copy(self) -> BindingsMap
⋮----
"""Return a copy of this instance.

        Return:
            New bindings object.
        """
copy = BindingsMap()
⋮----
def __rich_repr__(self) -> rich.repr.Result
⋮----
@classmethod
    def merge(cls, bindings: Iterable[BindingsMap]) -> BindingsMap
⋮----
"""Merge a bindings.

        Args:
            bindings: A number of bindings.

        Returns:
            New `BindingsMap`.
        """
keys: dict[str, list[Binding]] = {}
⋮----
def apply_keymap(self, keymap: Keymap) -> KeymapApplyResult
⋮----
"""Replace bindings for keys that are present in `keymap`.

        Preserves existing bindings for keys that are not in `keymap`.

        Args:
            keymap: A keymap to overlay.

        Returns:
            KeymapApplyResult: The result of applying the keymap, including any clashed bindings.
        """
clashed_bindings: set[Binding] = set()
new_bindings: dict[str, list[Binding]] = {}
⋮----
key_to_bindings = list(self.key_to_bindings.items())
⋮----
binding_id = binding.id
⋮----
# Bindings without an ID are irrelevant when applying a keymap
⋮----
# If the keymap has an override for this binding ID
⋮----
keymap_keys = keymap_key_string.split(",")
⋮----
# Remove the old binding
⋮----
# The key is already mapped either by default or by the keymap,
# so there's a clash unless the existing binding is being rebound
# to a different key.
clashing_bindings = self.key_to_bindings.get(
⋮----
# If the existing binding is not being rebound, it's a clash
⋮----
# Update the key_to_bindings with the new bindings
⋮----
@property
    def shown_keys(self) -> list[Binding]
⋮----
"""A list of bindings for shown keys."""
keys = [
⋮----
"""Bind keys to an action.

        Args:
            keys: The keys to bind. Can be a comma-separated list of keys.
            action: The action to bind the keys to.
            description: An optional description for the binding.
            show: A flag to say if the binding should appear in the footer.
            key_display: Optional string to display in the footer for the key.
            priority: Is this a priority binding, checked form app down to focused widget?
        """
all_keys = [key.strip() for key in keys.split(",")]
⋮----
def get_bindings_for_key(self, key: str) -> list[Binding]
⋮----
"""Get a list of bindings for a given key.

        Args:
            key: Key to look up.

        Raises:
            NoBinding: If the binding does not exist.

        Returns:
            A list of bindings associated with the key.
        """
⋮----
class KeymapApplyResult(NamedTuple)
⋮----
"""The result of applying a keymap."""
⋮----
clashed_bindings: set[Binding]
"""A list of bindings that were clashed and replaced by the keymap."""
</file>

</files>
